<!-- Wrapper -->
<div id="wrapper">

    <!-- Header -->
    <header id="header"{% if page.layout == "landing" %} class="alt style2"{% endif %}{% if page.layout == "home" %} class="alt"{% endif %}>
        <a href="{{ "" | absolute_url }}/" class="logo"><strong>{{ site.title }}</strong> <span>{{ site.subtitle }}</span></a>
        <nav>
            <a href="#menu">Menu</a>
            <!-- Language Selector inside an <a> tag for consistent styling -->
            <a style="margin-right: 20px; position: relative;">
                <select id="languageSelector" onchange="translateContent()" style="appearance: none; background: none; border: none; font-size: inherit; color: inherit; cursor: pointer; text-transform: uppercase; line-height: inherit;">
                    <option value="en">English</option>
                    <option value="zh-Hans">Chinese (Simplified)</option>
					<option value="fil">Filipino</option>
					<option value="id">Indonesian</option>
					<option value="it">Italian</option>
					<option value="ja">Japanese</option>
					<option value="ko">Korean</option>
					<option value="my">Myanmar</option>
					<option value="pt">Portuguese</option>
					<option value="th">Thai</option>
					<option value="vi">Vietnamese</option>
                    <!-- Add more languages as needed -->
                </select>
            </a>
        </nav>        
    </header>
    
    <!-- Menu -->
    <nav id="menu">
        <ul class="links">
            {% for page in site.pages %}
                {% if page.layout == "home" %}
                    <li><a href="{{ "" | absolute_url }}/">{{ page.title }}</a></li>
                {% endif %}
            {% endfor %}
            {% for page in site.html_pages %}
                {% if page.layout != "home" and page.nav-menu == true %}
                    <li><a href="{{ page.url | absolute_url }}">{{ page.title }}</a></li>
                {% endif %}
            {% endfor %}
        </ul>
    </nav>
</div>

<!-- Microsoft Translator Script -->
<script>
    document.addEventListener('DOMContentLoaded', function() {
		async function translateContent() {
			const contentElement = document.getElementById('content');
			if (!contentElement) {
				console.error('Content element with ID "content" not found.');
				return;
			}

			const targetLanguage = document.getElementById('languageSelector').value;

			// Gather all text nodes you want to translate, instead of the entire HTML structure
			const textNodes = contentElement.querySelectorAll('p, h1, h2, h3, h4, h5, h6, span'); // Adjust selectors as needed
			const textsToTranslate = Array.from(textNodes).map(node => node.innerText);

			const subscriptionKey = '1e5e3e1298d345dbbd3b5a0f54c4139c';  // Replace with your actual subscription key
			const region = 'southeastasia';  // Specify the region for your Azure resource
			const endpoint = 'https://api.cognitive.microsofttranslator.com/translate?api-version=3.0&to=' + targetLanguage;

			try {
				const response = await fetch(endpoint, {
					method: 'POST',
					headers: {
						'Ocp-Apim-Subscription-Key': subscriptionKey,
						'Ocp-Apim-Subscription-Region': region,  // Add the region header here
						'Content-Type': 'application/json'
					},
					body: JSON.stringify(textsToTranslate.map(text => ({ Text: text })))
				});

				if (response.ok) {
					const data = await response.json();
					data.forEach((translation, index) => {
						textNodes[index].innerText = translation.translations[0].text;
					});
				} else {
					console.error('Translation request failed', response.status, response.statusText);
				}
			} catch (error) {
				console.error('Error translating content:', error);
			}
		}
        // Attach the translateContent function to the global window object for access from the HTML
        window.translateContent = translateContent;
    });
</script>
